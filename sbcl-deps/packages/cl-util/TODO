1. Factor code for Lore project
2. Add tests
